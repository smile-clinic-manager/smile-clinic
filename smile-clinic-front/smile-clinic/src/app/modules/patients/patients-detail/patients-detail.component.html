<h1>Detalle Paciente</h1>
<mat-card>
  <mat-card-header>
    <button mat-icon-button [matMenuTriggerFor]="patientMenu" class="top-left-button" aria-label="patient menu">
      <mat-icon>more_vert</mat-icon>
    </button>

    <mat-menu #patientMenu="matMenu">
      <button mat-menu-item aria-label="edit" (click)="updatePatient()">
        <mat-icon>edit</mat-icon>
        Editar paciente
      </button>
      <mat-divider></mat-divider>
      <button mat-menu-item aria-label="delete" (click)="deletePatient()">
        <mat-icon>delete</mat-icon>
        Eliminar paciente
      </button>
    </mat-menu>
  </mat-card-header>

  <mat-card-content>
    <div>
      <h2 style="text-align: center; margin-bottom: 20px;">
        {{patient?.firstName}} {{patient?.lastName1}}
        {{patient?.lastName2}}
      </h2>
    </div>
    
    <div class="patient-data-container">
      <div class="patient-data-column">
        <div class="inline-patient-data">
          <p><strong>DNI: </strong></p>
          {{patient?.dni}}
        </div>

        <div class="inline-patient-data">
        <p><strong>Email: </strong></p>
        {{patient?.email}}
        </div>
        
        <div class="inline-patient-data">
          <p><strong>Teléfono: </strong></p>
          {{patient?.phoneNumber}}
        </div>
      </div>
      
      <div class="patient-data-column">
        <div class="inline-patient-data">
          <p><strong>Alergias: </strong></p>
          {{medicalHistory?.allergies}}
        </div>
  
        <div class="inline-patient-data">
          <p><strong>Patologías: </strong></p>
          @for(disease of diseases; track disease.id){
            <mat-chip>{{disease.name}}</mat-chip>
          }
        </div>
      </div>

    </div>
  </mat-card-content>

</mat-card>
<mat-tab-group>
  <mat-tab>
    <ng-template mat-tab-label>
      <mat-icon> list_alt </mat-icon> Tratamientos del paciente
    </ng-template>
    @defer(when medicalHistory !== undefined){
      <app-medical-record-entry-list [medicalHistoryDTO]="medicalHistory" (treatmentsModified)="reloadOdontogram()"></app-medical-record-entry-list>
    }
  </mat-tab>
  <mat-tab>
    <ng-template mat-tab-label>
      <mat-icon> dentistry </mat-icon> Odontograma
    </ng-template>
    @defer(when medicalHistory !== undefined){
      <app-odontogram [medicalHistoryDTO]="medicalHistory"></app-odontogram>
    }
  </mat-tab>
</mat-tab-group>